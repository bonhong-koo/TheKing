<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pcwk.ehr.tour">
    <resultMap type="com.pcwk.ehr.tour.domain.TourDTO" id="tourResultMap">
        <id property="tourNo" column="tour_no"/>
        <result property="name" column="name"/>
        <result property="subtitle" column="subtitle"/>
        <result property="contents" column="contents"/>
        <result property="views" column="views"/>
        <result property="address" column="address"/>
        <result property="holiday" column="holiday"/>
        <result property="time" column="time"/>
        <result property="tel" column="tel"/>
        <result property="fee" column="fee"/>
        <result property="regionNo" column="region_no"/>
            <association property="region" javaType="com.pcwk.ehr.region.domain.RegionDTO">
                <id property="regionNo" column="region_no"/>
                <result property="regionSido" column="region_sido"/>
                <result property="regionGugun" column="region_gugun"/>        
            </association>
    </resultMap>
	
    <insert id="doSaveTour" parameterType="com.pcwk.ehr.tour.domain.TourDTO">
		INSERT INTO TOUR (
		    tour_no,
		    name,
		    subtitle,
		    contents,
		    views,
		    address,
		    holiday,
		    time,
		    tel,
		    fee,
		    region_no
		) VALUES ( TOUR_NO_SEQ.NEXTVAL,
		           #{name},
		           #{subtitle},
		           #{contents},
		           0,
		           #{address},
		           #{holiday},
		           #{time},
		           #{tel},
		           #{fee},
		           #{regionNo} )
    </insert>
    
    <select id="getRegionNo" resultType="int" parameterType="com.pcwk.ehr.region.domain.RegionDTO">
        SELECT region_no
        FROM REGION
        WHERE region_sido = #{regionSido}
          AND region_gugun = #{regionGugun}
     </select> 
    
    
    <delete id="deleteAll">
        DELETE FROM TOUR
    </delete>

</mapper>